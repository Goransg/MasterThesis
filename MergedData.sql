CREATE 
    ALGORITHM = UNDEFINED 
    DEFINER = `goransg`@`localhost` 
    SQL SECURITY DEFINER
VIEW `mergeddata` AS
    SELECT 
        `inverter_data`.`Ts` AS `Ts`,
        `inverter_data`.`Avg1Hour.Total_Active_Power_Measurement` AS `Avg1Hour.Total_Active_Power_Measurement`,
        `inverter_data`.`Active_energy_produced_today` AS `Active_energy_produced_today`,
        `inverter_data`.`Controller_card_temperature` AS `Controller_card_temperature`,
        `inverter_data`.`Current_Measurement_of_Phase_1` AS `Current_Measurement_of_Phase_1`,
        `inverter_data`.`Current_Measurement_of_Phase_2` AS `Current_Measurement_of_Phase_2`,
        `inverter_data`.`Current_Measurement_of_Phase_3` AS `Current_Measurement_of_Phase_3`,
        `inverter_data`.`DC_Energy_generated_from_panels_on_Section_1` AS `DC_Energy_generated_from_panels_on_Section_1`,
        `inverter_data`.`DC_Energy_generated_from_panels_on_Section_2` AS `DC_Energy_generated_from_panels_on_Section_2`,
        `inverter_data`.`ERR00` AS `ERR00`,
        `inverter_data`.`ERR01` AS `ERR01`,
        `inverter_data`.`ERR02` AS `ERR02`,
        `inverter_data`.`ERR03` AS `ERR03`,
        `inverter_data`.`ERR04` AS `ERR04`,
        `inverter_data`.`ERR05` AS `ERR05`,
        `inverter_data`.`ERR06` AS `ERR06`,
        `inverter_data`.`ERR07` AS `ERR07`,
        `inverter_data`.`ERR08` AS `ERR08`,
        `inverter_data`.`ERR09` AS `ERR09`,
        `inverter_data`.`ERR10` AS `ERR10`,
        `inverter_data`.`ERR11` AS `ERR11`,
        `inverter_data`.`ERR12` AS `ERR12`,
        `inverter_data`.`ERR13` AS `ERR13`,
        `inverter_data`.`ERR14` AS `ERR14`,
        `inverter_data`.`ERR15` AS `ERR15`,
        `inverter_data`.`Error_Word_0` AS `Error_Word_0`,
        `inverter_data`.`Error_Word_1` AS `Error_Word_1`,
        `inverter_data`.`Error_Word_10` AS `Error_Word_10`,
        `inverter_data`.`Error_Word_11` AS `Error_Word_11`,
        `inverter_data`.`Error_Word_12` AS `Error_Word_12`,
        `inverter_data`.`Error_Word_13` AS `Error_Word_13`,
        `inverter_data`.`Error_Word_14` AS `Error_Word_14`,
        `inverter_data`.`Error_Word_15` AS `Error_Word_15`,
        `inverter_data`.`Error_Word_2` AS `Error_Word_2`,
        `inverter_data`.`Error_Word_3` AS `Error_Word_3`,
        `inverter_data`.`Error_Word_4` AS `Error_Word_4`,
        `inverter_data`.`Error_Word_5` AS `Error_Word_5`,
        `inverter_data`.`Error_Word_6` AS `Error_Word_6`,
        `inverter_data`.`Error_Word_7` AS `Error_Word_7`,
        `inverter_data`.`Error_Word_8` AS `Error_Word_8`,
        `inverter_data`.`Error_Word_9` AS `Error_Word_9`,
        `inverter_data`.`Grid_Frequency` AS `Grid_Frequency`,
        `inverter_data`.`Line_Voltage_Measurement_of_Phases_1_and_2` AS `Line_Voltage_Measurement_of_Phases_1_and_2`,
        `inverter_data`.`Line_Voltage_Measurement_of_Phases_2_and_3` AS `Line_Voltage_Measurement_of_Phases_2_and_3`,
        `inverter_data`.`Line_Voltage_Measurement_of_Phases_3_and_1` AS `Line_Voltage_Measurement_of_Phases_3_and_1`,
        `inverter_data`.`Liquid_Cooling_flow` AS `Liquid_Cooling_flow`,
        `inverter_data`.`Liquid_Cooling_input_presure` AS `Liquid_Cooling_input_presure`,
        `inverter_data`.`Liquid_Cooling_output_presure` AS `Liquid_Cooling_output_presure`,
        `inverter_data`.`Number_of_days_that_the_inverter_has_been_feeding_power_into_the` AS `Number_of_days_that_the_inverter_has_been_feeding_power_into_the`,
        `inverter_data`.`Number_of_days_that_the_inverter_has_been_on` AS `Number_of_days_that_the_inverter_has_been_on`,
        `inverter_data`.`Number_of_minutes_in_the_day_that_the_inverter_has_been_on` AS `Number_of_minutes_in_the_day_that_the_inverter_has_been_on`,
        `inverter_data`.`Number_of_minutes_that_the_inverter_has_been_feeding_power_into_` AS `Number_of_minutes_that_the_inverter_has_been_feeding_power_into`,
        `inverter_data`.`Power_Factor` AS `Power_Factor`,
        `inverter_data`.`Section_1_DC_Current_Measurement` AS `Section_1_DC_Current_Measurement`,
        `inverter_data`.`Section_1_DC_Power_Measurement` AS `Section_1_DC_Power_Measurement`,
        `inverter_data`.`Section_1_DC_Voltage_Measurement` AS `Section_1_DC_Voltage_Measurement`,
        `inverter_data`.`Section_1_Phase_1_power_module_temperature` AS `Section_1_Phase_1_power_module_temperature`,
        `inverter_data`.`Section_1_Phase_2_power_module_temperature` AS `Section_1_Phase_2_power_module_temperature`,
        `inverter_data`.`Section_1_Phase_3_power_module_temperature` AS `Section_1_Phase_3_power_module_temperature`,
        `inverter_data`.`Section_1_Status` AS `Section_1_Status`,
        `inverter_data`.`Section_2_DC_Current_Measurement` AS `Section_2_DC_Current_Measurement`,
        `inverter_data`.`Section_2_DC_Power_Measurement` AS `Section_2_DC_Power_Measurement`,
        `inverter_data`.`Section_2_DC_Voltage_Measurement` AS `Section_2_DC_Voltage_Measurement`,
        `inverter_data`.`Section_2_Phase_1_power_module_temperature` AS `Section_2_Phase_1_power_module_temperature`,
        `inverter_data`.`Section_2_Phase_2_power_module_temperature` AS `Section_2_Phase_2_power_module_temperature`,
        `inverter_data`.`Section_2_Phase_3_power_module_temperature` AS `Section_2_Phase_3_power_module_temperature`,
        `inverter_data`.`Section_2_Status` AS `Section_2_Status`,
        `inverter_data`.`Temperature_1-DC_connections_cabinet_ambient_temperature` AS `Temperature_1-DC_connections_cabinet_ambient_temperature`,
        `inverter_data`.`Temperature_10-Coolant_temperature_at_the_output_of_the_power_ca` AS `Temperature_10-Coolant_temperature_at_the_output_of_the_power_ca`,
        `inverter_data`.`Temperature_11-External_ambient_temperature` AS `Temperature_11-External_ambient_temperature`,
        `inverter_data`.`Temperature_2-AC_connections_cabinet_ambient_temperature` AS `Temperature_2-AC_connections_cabinet_ambient_temperature`,
        `inverter_data`.`Temperature_3-Section_1_temperature_of_inductance_core` AS `Temperature_3-Section_1_temperature_of_inductance_core`,
        `inverter_data`.`Temperature_4-Section_1_temperature_of_inductance_coil` AS `Temperature_4-Section_1_temperature_of_inductance_coil`,
        `inverter_data`.`Temperature_5-Section_2_temperature_of_inductance_core` AS `Temperature_5-Section_2_temperature_of_inductance_core`,
        `inverter_data`.`Temperature_6-Section_2_temperature_of_inductance_coil` AS `Temperature_6-Section_2_temperature_of_inductance_coil`,
        `inverter_data`.`Temperature_7-Power_cabinet_ambient_temperature` AS `Temperature_7-Power_cabinet_ambient_temperature`,
        `inverter_data`.`Temperature_8-Control_cabinet_ambient_temperature` AS `Temperature_8-Control_cabinet_ambient_temperature`,
        `inverter_data`.`Temperature_9-Coolant_temperature_at_the_input_of_the_power_cabi` AS `Temperature_9-Coolant_temperature_at_the_input_of_the_power_cabi`,
        `inverter_data`.`Total_Active_Energy_fed_into_the_grid_by_inverter` AS `Total_Active_Energy_fed_into_the_grid_by_inverter`,
        `inverter_data`.`Total_Active_Power_Measurement` AS `Total_Active_Power_Measurement`,
        `inverter_data`.`Total_Apparent_Power_Measurement` AS `Total_Apparent_Power_Measurement`,
        `inverter_data`.`Total_Capacitive_Reactive_Energy_in_the_inverter` AS `Total_Capacitive_Reactive_Energy_in_the_inverter`,
        `inverter_data`.`Total_Inductive_Reactive_Energy_in_the_inverter` AS `Total_Inductive_Reactive_Energy_in_the_inverter`,
        `inverter_data`.`Total_Reactive_Power_Measurement` AS `Total_Reactive_Power_Measurement`,
        `inverter_data`.`rowid_inv` AS `rowid_inv`,
        `weather_data`.`AmbientTemperature` AS `AmbientTemperature`,
        `weather_data`.`IrradiationHorizontal` AS `IrradiationHorizontal`,
        `weather_data`.`WindDirection` AS `WindDirection`,
        `weather_data`.`IrradiationInCline` AS `IrradiationInCline`,
        `weather_data`.`SoilingIndex` AS `SoilingIndex`,
        `weather_data`.`ModuleTemperature` AS `ModuleTemperature`,
        `weather_data`.`WindSpeed` AS `WindSpeed`
    FROM
        ((`inverter_data`
        LEFT JOIN `inverter_metadata` ON ((`inverter_metadata`.`Inverter` = `inverter_data`.`ID`)))
        LEFT JOIN `weather_data` ON (((`inverter_metadata`.`Parent` = `weather_data`.`WeatherStation`)
            AND (`inverter_data`.`Ts` = `weather_data`.`ts_ws`))))
    ORDER BY `inverter_data`.`rowid_inv`